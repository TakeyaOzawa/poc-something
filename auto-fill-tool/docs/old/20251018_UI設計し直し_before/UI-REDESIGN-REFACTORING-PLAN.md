# Auto-Fill Tool - UI/UX Redesign Refactoring Plan
# UI/UX再設計 修正方針とタスクリスト

**Version:** 4.0.0
**Date:** 2025-01-18
**Status:** Planning Phase

---

## 📋 目次

1. [修正方針](#修正方針)
2. [実装タスクリスト](#実装タスクリスト)
3. [マイルストーン](#マイルストーン)
4. [リスク管理](#リスク管理)
5. [成功基準](#成功基準)

---

## 修正方針

### 基本方針

```
🎯 目標: UIの高速化（50%削減）+ 保守性向上（80%改善）+ UX改善（Material Design 3準拠）
```

#### 1. **段階的移行（Incremental Refactoring）**

**なぜ**: 大規模なリライトはリスクが高く、デグレのリスクを最小化するため。

**方法**:
- 画面ごとに段階的に移行
- 各画面で機能テスト → リリース → 次の画面
- 既存のPresenter/UseCaseは維持（Alpine.jsはViewのみ）

#### 2. **既存コードとの共存**

**なぜ**: 全画面を一度にリライトするのは不可能。

**方法**:
```
src/presentation/
├── popup/
│   ├── index.ts              ← 既存（Presenter、ビジネスロジック）
│   ├── WebsitePresenter.ts   ← 既存
│   └── ...
└── public/
    └── popup.html            ← 新規（Alpine.js + Tailwind CSS）
```

#### 3. **コンポーネント優先（Component-First Approach）**

**なぜ**: 共通コンポーネントを先に作成し、全画面で再利用することで効率化。

**ステップ**:
1. **Week 1**: 共通コンポーネント作成（Button, Card, Modal, Toast, Table等）
2. **Week 2-6**: 各画面で共通コンポーネントを使用

#### 4. **パフォーマンス最優先**

**測定方法**:
- Chrome DevTools Performance プロファイリング
- Core Web Vitals測定（LCP, FID, CLS）
- メモリプロファイリング（長時間使用）

**最適化ターゲット**:
- 初期表示時間: 300ms → **150ms**（50%削減）
- 再レンダリング: 50ms → **20ms**（60%削減）
- バンドルサイズ: 1.05MB → **800KB**（24%削減）

#### 5. **テスト駆動（Test-Driven Refactoring）**

**各画面の移行前**:
1. 既存機能のE2Eテストを作成（Playwright）
2. 移行後に同じテストが合格することを確認

**テストカバレッジ目標**:
- E2Eテスト: 主要フロー100%
- ユニットテスト: Presenter層95%以上（既存維持）
- Alpine.jsコンポーネント: 80%以上（新規）

---

## 実装タスクリスト

### Phase 1: インフラ準備（Week 1）

#### Task 1.1: Tailwind CSS導入

**担当**: フロントエンド
**工数**: 2日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] `tailwindcss`パッケージをインストール
  ```bash
  npm install -D tailwindcss postcss autoprefixer
  npx tailwindcss init -p
  ```
- [ ] `tailwind.config.js`を設定（Content Pathsを設定）
- [ ] `postcss.config.js`を設定
- [ ] `public/styles/tailwind.css`を作成（@tailwind ディレクティブ）
- [ ] Webpackに`postcss-loader`を追加
- [ ] ビルドが成功することを確認

**成功基準**:
- `npm run build`でエラーなし
- `dist/`にTailwind CSSがバンドルされている

---

#### Task 1.2: Alpine.js CDN設定

**担当**: フロントエンド
**工数**: 1日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] `public/popup.html`に Alpine.js CDN スクリプトタグを追加
  ```html
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.14.0/dist/cdn.min.js"></script>
  ```
- [ ] 全HTMLファイルに同様に追加
- [ ] `x-data`でテストコンポーネントを作成し、動作確認

**成功基準**:
- Alpine.jsが各画面で動作する
- `x-data`, `x-show`等のディレクティブが機能する

---

#### Task 1.3: 共通コンポーネントライブラリ作成

**担当**: フロントエンド
**工数**: 3日
**優先度**: 🔥 高

**作業内容**:
- [ ] `public/styles/components.css`を作成
  - Button variants (btn-primary, btn-secondary, btn-danger, btn-success, btn-info)
  - Card styles
  - Modal styles
  - Toast styles
  - Form elements (form-input, form-select, form-label)
  - Table styles
- [ ] `public/components/alpine-components.html`を作成
  - `app-button`コンポーネント
  - `app-card`コンポーネント
  - `app-modal`コンポーネント
  - `app-toast`コンポーネント
  - `app-table`コンポーネント
- [ ] スタイルガイドページを作成（`docs/styleguide.html`）
- [ ] 各コンポーネントのデモとドキュメント

**成功基準**:
- すべてのコンポーネントがスタイルガイドで表示される
- Material Design 3準拠のビジュアル
- レスポンシブデザイン（320px〜1920px）

---

#### Task 1.4: Alpine Store設定（グローバル状態管理）

**担当**: フロントエンド
**工数**: 1日
**優先度**: 🔥 高

**作業内容**:
- [ ] `src/presentation/stores/app-store.ts`を作成
  - テーマ管理（light/dark）
  - 言語管理（ja/en）
  - 通知管理（toast）
  - ローディング状態
- [ ] 各画面で`Alpine.store('app')`を利用可能にする

**成功基準**:
- `$store.app.setTheme('dark')`で全画面のテーマが変更される
- `$store.app.showNotification('Success!')`でトースト表示

---

### Phase 2: 画面ごと段階移行（Week 2-5）

#### Task 2.1: popup.htmlの移行（Week 2）

**担当**: フロントエンド
**工数**: 5日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] **Day 1: HTML構造の書き換え**
  - `<div x-data="popupApp()">` でラップ
  - サイト一覧を`x-for`でレンダリング
  - ボタンを共通コンポーネントに変更
- [ ] **Day 2: Alpine.js ロジック実装**
  - `popup.ts`に`popupApp()`関数を作成
  - 既存の`WebsitePresenter`を呼び出し
  - モーダル開閉ロジックを`x-show`で実装
- [ ] **Day 3: スタイル適用**
  - Tailwind CSSクラスを適用
  - レスポンシブデザイン確認
  - ホバー/フォーカス状態の調整
- [ ] **Day 4: テスト作成**
  - E2Eテスト（Playwright）で主要フロー確認
  - Alpine.jsコンポーネントのユニットテスト
- [ ] **Day 5: パフォーマンス測定**
  - Chrome DevTools Performanceで計測
  - 初期表示時間が150ms以下か確認
  - メモリ使用量が5MB以下か確認

**成功基準**:
- 既存の全機能が動作する
- E2Eテストが100%合格
- 初期表示時間が150ms以下
- ビジュアルがMaterial Design 3準拠

---

#### Task 2.2: xpath-manager.htmlの移行（Week 3）

**担当**: フロントエンド
**工数**: 5日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] **Day 1-2: テーブルコンポーネント実装**
  - XPathステップ一覧をTailwind CSS Tableで実装
  - ソート機能（Alpine.jsの`x-sort`）
  - フィルター機能（検索ボックス）
- [ ] **Day 3: ドラッグ＆ドロップ並び替え**
  - Alpine.js + SortableJS統合
  - ステップの実行順序を変更可能に
- [ ] **Day 4: モーダルでステップ編集**
  - 編集モーダルをAlpine.jsで実装
  - フォームバリデーション
- [ ] **Day 5: CSV インポート/エクスポート**
  - 既存機能を維持しつつUIを刷新
  - プログレスバー表示

**成功基準**:
- 1000ステップ表示時の描画時間が300ms以下
- ドラッグ＆ドロップがスムーズ（60fps）
- CSV インポート/エクスポートが動作

---

#### Task 2.3: automation-variables-manager.htmlの移行（Week 4）

**担当**: フロントエンド
**工数**: 5日
**優先度**: 🔥 高

**作業内容**:
- [ ] **Day 1-2: 実行履歴カード実装**
  - カードレイアウト（Tailwind CSS）
  - ステータスバッジ（成功/失敗）
  - 日時フォーマット
- [ ] **Day 3: フィルター・検索機能**
  - ステータスフィルター（全て/成功/失敗）
  - 日付範囲フィルター
  - サイト名フィルター
  - 検索ボックス
- [ ] **Day 4: 録画視聴モーダル**
  - `<video>`タグで録画再生
  - モーダルでフルスクリーン表示
- [ ] **Day 5: ページネーション**
  - 10件ずつ表示
  - ページ切り替えアニメーション

**成功基準**:
- 1000件の履歴でもフィルターが100ms以下
- 録画視聴がスムーズ
- ページネーションが動作

---

#### Task 2.4: system-settings.htmlの移行（Week 5-前半）

**担当**: フロントエンド
**工数**: 3日
**優先度**: 🔥 高

**作業内容**:
- [ ] **Day 1: タブUI実装**
  - 4つのタブ（一般、リトライ、録画、セキュリティ）
  - タブ切り替えアニメーション
- [ ] **Day 2: 設定フォーム実装**
  - 各タブの設定項目をフォームで実装
  - リアルタイムバリデーション
- [ ] **Day 3: 保存・リセット機能**
  - 保存ボタンでChrome Storageに保存
  - リセットボタンでデフォルト値に戻す
  - トースト通知

**成功基準**:
- 全タブが動作
- 設定が正しく保存される
- UIがレスポンシブ

---

#### Task 2.5: 認証画面の移行（Week 5-後半）

**担当**: フロントエンド
**工数**: 2日
**優先度**: 普通

**作業内容**:
- [ ] **Day 1: master-password-setup.htmlの移行**
  - パスワード入力フォーム
  - 強度インジケーター
  - バリデーション
- [ ] **Day 2: unlock.htmlの移行**
  - パスワード入力
  - エラーメッセージ
  - エンターキーで送信

**成功基準**:
- パスワード設定・ロック解除が動作
- バリデーションが機能
- エラー表示がわかりやすい

---

#### Task 2.6: storage-sync-manager.htmlの移行（Week 5-後半）

**担当**: フロントエンド
**工数**: 2日
**優先度**: 普通

**作業内容**:
- [ ] **Day 1: 同期設定カード実装**
  - カードレイアウト
  - ステータス表示（正常/エラー）
  - 最終同期時刻
- [ ] **Day 2: 同期実行UI**
  - 手動同期ボタン
  - プログレスバー
  - エラーハンドリング

**成功基準**:
- 同期設定が表示される
- 手動同期が動作
- エラー時にユーザーに通知

---

### Phase 3: テスト・最適化（Week 6）

#### Task 3.1: 全画面の統合テスト

**担当**: QA
**工数**: 2日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] 全画面のE2Eテストを実行
- [ ] 主要フロー100%をカバー
- [ ] クロスブラウザテスト（Chrome, Edge）

**成功基準**:
- E2Eテストが100%合格
- デグレなし

---

#### Task 3.2: パフォーマンステスト

**担当**: フロントエンド
**工数**: 2日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] Chrome DevTools Performanceで全画面を計測
- [ ] Core Web Vitals測定（LCP, FID, CLS）
- [ ] メモリリークチェック（長時間使用）
- [ ] 最適化（必要に応じて）

**成功基準**:
- 全画面で初期表示時間が150ms以下
- メモリリークなし
- Core Web Vitals目標達成

---

#### Task 3.3: アクセシビリティ監査

**担当**: フロントエンド
**工数**: 1日
**優先度**: 🔥 高

**作業内容**:
- [ ] axe DevToolsでアクセシビリティチェック
- [ ] キーボード操作確認
- [ ] スクリーンリーダー確認
- [ ] 色のコントラスト比確認

**成功基準**:
- WCAG 2.1 AA準拠
- axeで0エラー

---

### Phase 4: ドキュメント更新（Week 6）

#### Task 4.1: ユーザーマニュアル更新

**担当**: ドキュメント
**工数**: 1日
**優先度**: 普通

**作業内容**:
- [ ] README.mdを更新
- [ ] スクリーンショットを新しいUIに更新
- [ ] 新機能の説明を追加

---

#### Task 4.2: 開発者ドキュメント更新

**担当**: フロントエンド
**工数**: 1日
**優先度**: 普通

**作業内容**:
- [ ] Alpine.js + Tailwind CSSの使い方をドキュメント化
- [ ] 共通コンポーネントの使い方
- [ ] スタイルガイド

---

### Phase 5: リリース（Week 7）

#### Task 5.1: ベータテスト

**担当**: QA
**工数**: 3日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] ベータ版をテストユーザーに配布
- [ ] フィードバック収集
- [ ] バグ修正

**成功基準**:
- クリティカルバグ0件

---

#### Task 5.2: プロダクションリリース

**担当**: DevOps
**工数**: 1日
**優先度**: ⚡ 最高

**作業内容**:
- [ ] ビルド最終確認
- [ ] Chrome Web Storeに公開
- [ ] リリースノート作成

**成功基準**:
- 正常にデプロイ
- ユーザーが新バージョンにアップデート可能

---

## マイルストーン

| Week | フェーズ | 主な成果物 | 完了基準 |
|------|---------|-----------|---------|
| Week 1 | Phase 1 | Tailwind CSS + Alpine.js環境構築、共通コンポーネント | ビルド成功、スタイルガイド完成 |
| Week 2 | Phase 2.1 | popup.html移行完了 | E2Eテスト合格、パフォーマンス目標達成 |
| Week 3 | Phase 2.2 | xpath-manager.html移行完了 | E2Eテスト合格、1000行描画300ms以下 |
| Week 4 | Phase 2.3 | automation-variables-manager.html移行完了 | E2Eテスト合格、フィルター100ms以下 |
| Week 5 | Phase 2.4-2.6 | 残り3画面移行完了 | 全画面動作確認 |
| Week 6 | Phase 3 | 統合テスト、パフォーマンステスト、アクセシビリティ監査 | 全テスト合格、WCAG準拠 |
| Week 7 | Phase 4-5 | ドキュメント更新、ベータテスト、リリース | プロダクションリリース成功 |

---

## リスク管理

### 高リスク項目

| リスク | 影響 | 確率 | 軽減策 |
|-------|------|------|-------|
| **既存機能のデグレ** | 高 | 中 | E2Eテストを先に作成、段階的移行 |
| **パフォーマンス目標未達** | 中 | 低 | 早期にプロファイリング、最適化時間を確保 |
| **Alpine.jsの学習コスト** | 中 | 中 | チュートリアル実施、ペアプログラミング |
| **スケジュール遅延** | 高 | 中 | 優先度を明確化、必要に応じてスコープ調整 |
| **ブラウザ互換性問題** | 低 | 低 | Chrome/Edge最新版のみサポート |

---

## 成功基準

### 技術的成功基準

| 指標 | 現状 | 目標 | 測定方法 |
|-----|------|------|---------|
| 初期表示時間（popup） | 300ms | **150ms以下** | Chrome DevTools Performance |
| 再レンダリング | 50ms | **20ms以下** | Performance Observer API |
| バンドルサイズ | 1.05MB | **800KB以下** | Webpack Bundle Analyzer |
| メモリ使用量 | 8MB | **5MB以下** | Chrome DevTools Memory |
| E2Eテスト合格率 | - | **100%** | Playwright Test Report |
| アクセシビリティスコア | - | **AA準拠** | axe DevTools |

### ビジネス的成功基準

- **ユーザー満足度**: ベータテストでの肯定的フィードバック80%以上
- **バグ報告**: リリース後1週間でクリティカルバグ0件
- **パフォーマンス**: ユーザーから「速くなった」というフィードバック50%以上

---

## まとめ

この修正方針とタスクリストに従い、7週間でAlpine.js + Tailwind CSSへの全画面移行を完了します：

- **Week 1**: 環境構築
- **Week 2-5**: 画面ごと段階移行
- **Week 6**: テスト・最適化
- **Week 7**: リリース

各タスクは明確な成功基準を持ち、リスク管理とマイルストーンで進捗を追跡します。

次のステップ: 各タスクを開発チームに割り当て、Week 1からスタートします。
