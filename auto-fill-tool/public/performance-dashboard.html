<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="performanceDashboard">パフォーマンスダッシュボード</title>
    <link rel="stylesheet" href="styles/design-system.css">
    <script defer src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body style="background: var(--color-background); min-height: 100vh;">
    <div x-data="performanceDashboardApp()" class="min-h-screen flex flex-col">
        
        <!-- Header -->
        <header class="nav-header">
            <div class="flex items-center gap-3">
                <a href="popup.html" class="nav-back">
                    <span>←</span>
                    <span data-i18n="back">戻る</span>
                </a>
                <div class="nav-title">
                    <span>📊</span>
                    <span data-i18n="performanceDashboard">パフォーマンスダッシュボード</span>
                </div>
            </div>
            <div class="nav-actions">
                <button class="btn btn-secondary btn-sm" @click="refreshData()">
                    <span>🔄</span>
                    <span data-i18n="refresh">更新</span>
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="flex-1 container py-6">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6">
                
                <!-- Metrics Cards -->
                <div class="card">
                    <div class="card-body text-center">
                        <div class="text-3xl mb-2">⚡</div>
                        <div class="text-title mb-1">平均実行時間</div>
                        <div class="text-headline text-primary">45.2秒</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body text-center">
                        <div class="text-3xl mb-2">✅</div>
                        <div class="text-title mb-1">成功率</div>
                        <div class="text-headline text-success">94.5%</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body text-center">
                        <div class="text-3xl mb-2">🔄</div>
                        <div class="text-title mb-1">総実行回数</div>
                        <div class="text-headline">1,247</div>
                    </div>
                </div>
                
                <div class="card">
                    <div class="card-body text-center">
                        <div class="text-3xl mb-2">💾</div>
                        <div class="text-title mb-1">メモリ使用量</div>
                        <div class="text-headline">4.2MB</div>
                    </div>
                </div>
                
            </div>

            <!-- Charts -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                
                <!-- Execution Time Chart -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-title">実行時間の推移</h3>
                    </div>
                    <div class="card-body">
                        <canvas id="executionTimeChart" width="400" height="200"></canvas>
                    </div>
                </div>
                
                <!-- Success Rate Chart -->
                <div class="card">
                    <div class="card-header">
                        <h3 class="text-title">成功率の推移</h3>
                    </div>
                    <div class="card-body">
                        <canvas id="successRateChart" width="400" height="200"></canvas>
                    </div>
                </div>
                
            </div>
        </main>
    </div>

    <script>
        // Theme detection
        function detectTheme() {
            const isDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
        }
        
        // Initial theme detection
        detectTheme();
        
        // Listen for theme changes
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', detectTheme);

        function performanceDashboardApp() {
            return {
                init() {
                    this.initCharts();
                },

                initCharts() {
                    // Execution Time Chart
                    const ctx1 = document.getElementById('executionTimeChart').getContext('2d');
                    new Chart(ctx1, {
                        type: 'line',
                        data: {
                            labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
                            datasets: [{
                                label: '平均実行時間（秒）',
                                data: [52, 48, 45, 43, 46, 45],
                                borderColor: 'rgb(25, 118, 210)',
                                backgroundColor: 'rgba(25, 118, 210, 0.1)',
                                tension: 0.4
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: false
                                }
                            },
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });

                    // Success Rate Chart
                    const ctx2 = document.getElementById('successRateChart').getContext('2d');
                    new Chart(ctx2, {
                        type: 'doughnut',
                        data: {
                            labels: ['成功', '失敗'],
                            datasets: [{
                                data: [94.5, 5.5],
                                backgroundColor: [
                                    'rgb(67, 160, 71)',
                                    'rgb(229, 57, 53)'
                                ]
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    position: 'bottom'
                                }
                            }
                        }
                    });
                },

                refreshData() {
                    console.log('Refreshing performance data...');
                }
            };
        }
    </script>
</body>
</html>
